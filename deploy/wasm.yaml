apiVersion: extensions.istio.io/v1alpha1
kind: WasmPlugin
metadata:
  name: wasm
spec:
  selector:
    matchLabels:
      app: caller
  url: oci://docker.io/wangdengwu/wasm:v1.0.0
  sha256: 31b1fb19a95806beae6fd944361bce86a392e23de15b0d9a6f5d7e7d659a08c2
  match:
    - mode: CLIENT
  pluginConfig:
    config:
      name: wdw
      age : 30
      array:
        - test1: 1
          test2: 2
          test3: 3
        - test4: 4
  vmConfig:
    env:
      - name: POD_NAME
        valueFrom: HOST
      - name: TRUST_DOMAIN
        value: "cluster.local"
  phase: AUTHN